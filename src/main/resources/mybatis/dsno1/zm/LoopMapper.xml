<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.yy.mapper.dsno1.zm.LoopMapper">

    <!--表名 -->
    <sql id="tableName">
        ZM_LOOP
    </sql>

    <!--数据字典表名 -->
    <sql id="dicTableName">
        SYS_DICTIONARIES
    </sql>

    <!-- 字段 -->
    <sql id="Field">
        f
        .
        FName
        ,
		f.FCode,	
		f.Region,	
		f.FStatus,	
		f.FVariable,	
		f.Creator,	
		f.CreateTime,	
		f.Modified,	
		f.ModifiedTime,	
		f.Workshop,
		f.FGroup,
        f.FTimeStatus,
		f.LOOP_ID,
        f.FType,
        f.FRow,
        f.FCol,
        f.Remark
    </sql>

    <!-- 字段用于新增 -->
    <sql id="Field2">
        FName
        ,
		FCode,	
		Region,	
		FStatus,	
		FVariable,	
		Creator,	
		CreateTime,	
		Modified,	
		ModifiedTime,	
		Workshop,
		FGroup,
        FTimeStatus,
		LOOP_ID,
        FType,
        FRow,
        FCol,
        Remark
    </sql>

    <!-- 字段值 -->
    <sql id="FieldValue">
        #{FName}
        ,
        #{FCode},
        #{Region},
        #{FStatus},
        #{FVariable},
        #{Creator},
        #{CreateTime},
        #{Modified},
        #{ModifiedTime},
        #{Workshop},
        #{FGroup},
        #{FTimeStatus},
        #{LOOP_ID},
        #{FType},
        #{FRow},
        #{FCol},
        #{Remark}
    </sql>

    <!-- 新增-->
    <insert id="save" parameterType="pd">
        insert into
        <include refid="tableName"></include>
        (
        <include refid="Field2"></include>
        ) values (
        <include refid="FieldValue"></include>
        )
    </insert>

    <!-- 删除-->
    <delete id="delete" parameterType="pd">
        delete from
        <include refid="tableName"></include>
        where
        LOOP_ID = #{LOOP_ID}
    </delete>

    <!-- 修改 -->
    <update id="edit" parameterType="pd">
        update
        <include refid="tableName"></include>
        set
        FName = #{FName},
        FCode = #{FCode},
        Region = #{Region},
        FVariable = #{FVariable},
        Modified = #{Modified},
        ModifiedTime = #{ModifiedTime},
        Workshop = #{Workshop},
        FGroup = #{FGroup},
        LOOP_ID = LOOP_ID,
        FType = #{FType},
        FRow = #{FRow},
        FCol = #{FCol},
        Remark= #{Remark}
        where
        LOOP_ID = #{LOOP_ID}
    </update>

    <update id="editStatus" parameterType="pd">
        update
        <include refid="tableName"></include>
        set
        FStatus = #{FStatus}
        where
        LOOP_ID = #{LOOP_ID}
    </update>

    <update id="editStatusByType" parameterType="pd">
        update
        <include refid="tableName"></include>
        set
        FStatus = #{FStatus}
        where
        FType = #{FType}
    </update>

    <update id="editStatusAll" parameterType="list">
        update
        <include refid="tableName"></include>
        set FStatus =
        <foreach collection="list" item="item" index="index" separator=" " open="case LOOP_ID" close="end">
            when #{item.LOOP_ID} then #{item.FStatus}
        </foreach>
        where LOOP_ID in
        <foreach collection="list" index="index" item="item" separator="," open="(" close=")">
            #{item.LOOP_ID}
        </foreach>
    </update>

    <update id="editTimeStatus" parameterType="pd">
        update
        <include refid="tableName"></include>
        set
        FTimeStatus = #{FTimeStatus}
        where
        LOOP_ID = #{LOOP_ID}
    </update>

    <update id="editAllStatus" parameterType="pd">
        UPDATE ZM_Loop SET FStatus = #{FStatus}
    </update>

    <!-- 通过ID获取数据 -->
    <select id="findById" parameterType="pd" resultType="pd">
        select
        <include refid="Field"></include>
        from
        <include refid="tableName"></include>
        f
        where
        f.LOOP_ID = #{LOOP_ID}
    </select>

    <!-- 列表 -->
    <select id="datalistPage" parameterType="page" resultType="pd">
        select
        <include refid="Field"></include>,a.FNAME AreaName
        from
        <include refid="tableName"></include>
        f
        left join MDM_AREA a on a.AREA_ID = f.Workshop
        where 1=1
        <if test="pd.KEYWORDS != null and pd.KEYWORDS != ''"><!-- 关键词检索 -->
            and
            (
            f.FName LIKE '%'+ #{pd.KEYWORDS}+'%'
            or
            f.FCode LIKE '%'+ #{pd.KEYWORDS}+'%'
            )

        </if>
        <if test="pd.Workshop != null and pd.Workshop != ''"><!-- 关键词检索 -->
            and f.Workshop = #{pd.Workshop}
        </if>
        <if test="pd.FStatus != null and pd.FStatus != ''"><!-- 关键词检索 -->
            and f.FStatus = #{pd.FStatus}
        </if>
        <if test="pd.FType != null and pd.FType != ''"><!-- 关键词检索 -->
            and f.FType = #{pd.FType}
        </if>
        <if test="pd.Location != null and pd.Location != ''"><!-- 关键词检索 -->
            and f.Region like '%'+ #{pd.Location}+'%'
        </if>
        [fhstart]ORDER BY CreateTime DESC[fhend]
    </select>

    <!-- 根据逗号分隔ID查询数据分页列表 -->
    <select id="loopdatalistPage" parameterType="page" resultType="pd">
        select
        <include refid="Field"></include>,a.FNAME AreaName
        from
        <include refid="tableName"></include>
        f
        left join MDM_AREA a on a.AREA_ID = f.Workshop
        where 1=1
        <if test="pd.IDS != null and pd.IDS != ''"><!-- 关键词检索 -->
            and LOOP_ID in
            ${pd.IDS}
        </if>
        [fhstart]ORDER BY CreateTime DESC[fhend]
    </select>

    <!-- 根据逗号分隔ID查询数据全部列表 -->
    <select id="loopAllByIDS" parameterType="pd" resultType="pd">
        select
        <include refid="Field"></include>,a.FNAME AreaName
        from
        <include refid="tableName"></include>
        f
        left join MDM_AREA a on a.AREA_ID = f.Workshop
        where 1=1
        <if test="IDS != null and IDS != ''"><!-- 关键词检索 -->
            and LOOP_ID in
            ${IDS}
        </if>
        ORDER BY CreateTime DESC
    </select>

    <!-- 列表(全部) -->
    <select id="listAll" parameterType="pd" resultType="pd">
        select
        <include refid="Field"></include>,a.FNAME AreaName
        from
        <include refid="tableName"></include>
        f
        left join MDM_AREA a on a.AREA_ID = f.Workshop
        where 1=1
        <if test="WORKSHOP_ID != null and WORKSHOP_ID != ''"><!-- 关键词检索 -->
            and f.Workshop = #{WORKSHOP_ID}
        </if>
        <if test="FName != null and FName != ''"><!-- 关键词检索 -->
            and f.FCode = #{FName}
        </if>

        <if test="KEYWORDS != null and KEYWORDS != ''"><!-- 关键词检索 -->
            and
            (
            f.FName LIKE '%'+ #{KEYWORDS}+'%'
            or
            f.FCode LIKE '%'+ #{KEYWORDS}+'%'
            )

        </if>
        <if test="Workshop != null and Workshop != ''"><!-- 关键词检索 -->
            and f.Workshop = #{Workshop}
        </if>
        <if test="FStatus != null and FStatus != ''"><!-- 关键词检索 -->
            and f.FStatus = #{FStatus}
        </if>
        <if test="FType != null and FType != ''"><!-- 关键词检索 -->
            and f.FType = #{FType}
        </if>
        <if test="Location != null and Location != ''"><!-- 关键词检索 -->
            and f.Region like '%'+ #{Location}+'%'
        </if>
        ORDER BY CreateTime DESC
    </select>

    <!-- 列表(全部) -->
    <select id="loopOnAllByIDS" parameterType="pd" resultType="pd">
        select
        <include refid="Field"></include>,a.FNAME AreaName
        from
        <include refid="tableName"></include>
        f
        left join MDM_AREA a on a.AREA_ID = f.Workshop
        where FTimeStatus = '1'
        <if test="IDS != null and IDS != ''"><!-- 关键词检索 -->
            and LOOP_ID in
            ${IDS}
        </if>
        ORDER BY CreateTime DESC
    </select>

<!--    获取回路列表-->
    <select id="getLoopList" resultType="org.yy.entity.PageData">
        select
        <include refid="Field"></include>,a.FNAME AreaName
        from
        <include refid="tableName"></include>
        f
        left join MDM_AREA a on a.AREA_ID = f.Workshop
        where 1=1
        <if test="WORKSHOP_ID != null and WORKSHOP_ID != ''"><!-- 关键词检索 -->
            and f.Workshop = #{WORKSHOP_ID}
        </if>
        <if test="FName != null and FName != ''"><!-- 关键词检索 -->
            and f.FCode = #{FName}
        </if>

        <if test="KEYWORDS != null and KEYWORDS != ''"><!-- 关键词检索 -->
            and
            (
            f.FName LIKE '%'+ #{KEYWORDS}+'%'
            or
            f.FCode LIKE '%'+ #{KEYWORDS}+'%'
            )

        </if>
        <if test="Workshop != null and Workshop != ''"><!-- 关键词检索 -->
            and f.Workshop = #{Workshop}
        </if>
        <if test="FStatus != null and FStatus != ''"><!-- 关键词检索 -->
            and f.FStatus = #{FStatus}
        </if>
        <if test="FType != null and FType != ''"><!-- 关键词检索 -->
            and f.FType = #{FType}
        </if>
        <if test="Location != null and Location != ''"><!-- 关键词检索 -->
            and f.Region like '%'+ #{Location}+'%'
        </if>
        ORDER BY CreateTime DESC
    </select>

    <!-- 批量删除 -->
    <delete id="deleteAll" parameterType="String">
        delete from
        <include refid="tableName"></include>
        where
        LOOP_ID in
        <foreach item="item" index="index" collection="array" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>


    <!-- yy356703572qq(彬耶) -->
</mapper>